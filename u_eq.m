function u_i = u_eq(n, T, u_im, mu_i, mu_im, eps, d, rho_i, rho_im, Pim, A_f, dz)

R = 8.314;

u_i = ((((8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (100*mu_i*(4*Pim*d^2*eps^2 + 7*dz*rho_im*d*eps^2*u_im^2 - 7*dz*rho_im*d*eps*u_im^2 - 600*dz*mu_im*eps^2*u_im + 1200*dz*mu_im*eps*u_im - 600*dz*mu_im*u_im))/(49*d^2*dz*eps^2*rho_i^2) - (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^2 + (- 28*Pim*rho_i*d^3*eps^3 - 49*dz*rho_i*rho_im*d^2*eps^3*u_im^2 + 49*dz*rho_i*rho_im*d^2*eps^2*u_im^2 + 4200*dz*mu_im*rho_i*d*eps^3*u_im - 8400*dz*mu_im*rho_i*d*eps^2*u_im + 4200*dz*mu_im*rho_i*d*eps*u_im - 120000*dz*eps^3*mu_i^2 + 360000*dz*eps^2*mu_i^2 - 360000*dz*eps*mu_i^2 + 120000*dz*mu_i^2)^3/(3176523*d^6*dz^3*eps^6*rho_i^6*(eps - 1)^3))^(1/2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (100*mu_i*(4*Pim*d^2*eps^2 + 7*dz*rho_im*d*eps^2*u_im^2 - 7*dz*rho_im*d*eps*u_im^2 - 600*dz*mu_im*eps^2*u_im + 1200*dz*mu_im*eps*u_im - 600*dz*mu_im*u_im))/(49*d^2*dz*eps^2*rho_i^2) - (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3) + (200*mu_i*(eps - 1))/(7*d*eps*rho_i) - (- 28*Pim*rho_i*d^3*eps^3 - 49*dz*rho_i*rho_im*d^2*eps^3*u_im^2 + 49*dz*rho_i*rho_im*d^2*eps^2*u_im^2 + 4200*dz*mu_im*rho_i*d*eps^3*u_im - 8400*dz*mu_im*rho_i*d*eps^2*u_im + 4200*dz*mu_im*rho_i*d*eps*u_im - 120000*dz*eps^3*mu_i^2 + 360000*dz*eps^2*mu_i^2 - 360000*dz*eps*mu_i^2 + 120000*dz*mu_i^2)/(147*d^2*dz*eps^2*rho_i^2*(eps - 1)*((((8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (100*mu_i*(4*Pim*d^2*eps^2 + 7*dz*rho_im*d*eps^2*u_im^2 - 7*dz*rho_im*d*eps*u_im^2 - 600*dz*mu_im*eps^2*u_im + 1200*dz*mu_im*eps*u_im - 600*dz*mu_im*u_im))/(49*d^2*dz*eps^2*rho_i^2) - (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^2 + (- 28*Pim*rho_i*d^3*eps^3 - 49*dz*rho_i*rho_im*d^2*eps^3*u_im^2 + 49*dz*rho_i*rho_im*d^2*eps^2*u_im^2 + 4200*dz*mu_im*rho_i*d*eps^3*u_im - 8400*dz*mu_im*rho_i*d*eps^2*u_im + 4200*dz*mu_im*rho_i*d*eps*u_im - 120000*dz*eps^3*mu_i^2 + 360000*dz*eps^2*mu_i^2 - 360000*dz*eps*mu_i^2 + 120000*dz*mu_i^2)^3/(3176523*d^6*dz^3*eps^6*rho_i^6*(eps - 1)^3))^(1/2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (100*mu_i*(4*Pim*d^2*eps^2 + 7*dz*rho_im*d*eps^2*u_im^2 - 7*dz*rho_im*d*eps*u_im^2 - 600*dz*mu_im*eps^2*u_im + 1200*dz*mu_im*eps*u_im - 600*dz*mu_im*u_im))/(49*d^2*dz*eps^2*rho_i^2) - (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3));
 
%u_i = (((4*(49*R*T*n*d^4*eps^3*rho_i^2 + 1400*A_f*Pim*d^3*eps^4*mu_i*rho_i - 1400*A_f*Pim*d^3*eps^3*mu_i*rho_i + 4000000*A_f*dz*eps^4*mu_i^3 - 16000000*A_f*dz*eps^3*mu_i^3 + 24000000*A_f*dz*eps^2*mu_i^3 - 16000000*A_f*dz*eps*mu_i^3 + 4000000*A_f*dz*mu_i^3)^2)/(117649*A_f^2*d^6*dz^2*eps^6*rho_i^6*(eps - 1)^2) - (64*(7*Pim*rho_i*d^3*eps^3 + 30000*dz*eps^3*mu_i^2 - 90000*dz*eps^2*mu_i^2 + 90000*dz*eps*mu_i^2 - 30000*dz*mu_i^2)^3)/(3176523*d^6*dz^3*eps^6*rho_i^6*(eps - 1)^3))^(1/2) + (400*Pim*mu_i)/(49*dz*rho_i^2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3) + (200*mu_i*(eps - 1))/(7*d*eps*rho_i) + (4*(7*Pim*rho_i*d^3*eps^3 + 30000*dz*eps^3*mu_i^2 - 90000*dz*eps^2*mu_i^2 + 90000*dz*eps*mu_i^2 - 30000*dz*mu_i^2))/(147*d^2*dz*eps^2*rho_i^2*(eps - 1)*(((4*(49*R*T*n*d^4*eps^3*rho_i^2 + 1400*A_f*Pim*d^3*eps^4*mu_i*rho_i - 1400*A_f*Pim*d^3*eps^3*mu_i*rho_i + 4000000*A_f*dz*eps^4*mu_i^3 - 16000000*A_f*dz*eps^3*mu_i^3 + 24000000*A_f*dz*eps^2*mu_i^3 - 16000000*A_f*dz*eps*mu_i^3 + 4000000*A_f*dz*mu_i^3)^2)/(117649*A_f^2*d^6*dz^2*eps^6*rho_i^6*(eps - 1)^2) - (64*(7*Pim*rho_i*d^3*eps^3 + 30000*dz*eps^3*mu_i^2 - 90000*dz*eps^2*mu_i^2 + 90000*dz*eps*mu_i^2 - 30000*dz*mu_i^2)^3)/(3176523*d^6*dz^3*eps^6*rho_i^6*(eps - 1)^3))^(1/2) + (400*Pim*mu_i)/(49*dz*rho_i^2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3));

%u_i = real( (((64*(7*Pim*rho_i*d^3*eps^3 - 30000*dz*eps^3*mu_i^2 + 90000*dz*eps^2*mu_i^2 - 90000*dz*eps*mu_i^2 + 30000*dz*mu_i^2)^3)/(3176523*d^6*dz^3*eps^6*rho_i^6*(eps - 1)^3) + (4*(49*R*T*n*d^4*eps^3*rho_i^2 - 1400*A_f*Pim*d^3*eps^4*mu_i*rho_i + 1400*A_f*Pim*d^3*eps^3*mu_i*rho_i + 4000000*A_f*dz*eps^4*mu_i^3 - 16000000*A_f*dz*eps^3*mu_i^3 + 24000000*A_f*dz*eps^2*mu_i^3 - 16000000*A_f*dz*eps*mu_i^3 + 4000000*A_f*dz*mu_i^3)^2)/(117649*A_f^2*d^6*dz^2*eps^6*rho_i^6*(eps - 1)^2))^(1/2) - (400*Pim*mu_i)/(49*dz*rho_i^2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3) + (200*mu_i*(eps - 1))/(7*d*eps*rho_i) - (4*(7*Pim*rho_i*d^3*eps^3 - 30000*dz*eps^3*mu_i^2 + 90000*dz*eps^2*mu_i^2 - 90000*dz*eps*mu_i^2 + 30000*dz*mu_i^2))/(147*d^2*dz*eps^2*rho_i^2*(eps - 1)*(((64*(7*Pim*rho_i*d^3*eps^3 - 30000*dz*eps^3*mu_i^2 + 90000*dz*eps^2*mu_i^2 - 90000*dz*eps*mu_i^2 + 30000*dz*mu_i^2)^3)/(3176523*d^6*dz^3*eps^6*rho_i^6*(eps - 1)^3) + (4*(49*R*T*n*d^4*eps^3*rho_i^2 - 1400*A_f*Pim*d^3*eps^4*mu_i*rho_i + 1400*A_f*Pim*d^3*eps^3*mu_i*rho_i + 4000000*A_f*dz*eps^4*mu_i^3 - 16000000*A_f*dz*eps^3*mu_i^3 + 24000000*A_f*dz*eps^2*mu_i^3 - 16000000*A_f*dz*eps*mu_i^3 + 4000000*A_f*dz*mu_i^3)^2)/(117649*A_f^2*d^6*dz^2*eps^6*rho_i^6*(eps - 1)^2))^(1/2) - (400*Pim*mu_i)/(49*dz*rho_i^2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3)) );

%u_i = (((64*(7*Pim*rho_i*d^3*eps^3 - 30000*dz*eps^3*mu_i^2 + 90000*dz*eps^2*mu_i^2 - 90000*dz*eps*mu_i^2 + 30000*dz*mu_i^2)^3)/(3176523*d^6*dz^3*eps^6*rho_i^6*(eps - 1)^3) + (4*(49*R*T*n*d^4*eps^3*rho_i^2 - 1400*A_f*Pim*d^3*eps^4*mu_i*rho_i + 1400*A_f*Pim*d^3*eps^3*mu_i*rho_i + 4000000*A_f*dz*eps^4*mu_i^3 - 16000000*A_f*dz*eps^3*mu_i^3 + 24000000*A_f*dz*eps^2*mu_i^3 - 16000000*A_f*dz*eps*mu_i^3 + 4000000*A_f*dz*mu_i^3)^2)/(117649*A_f^2*d^6*dz^2*eps^6*rho_i^6*(eps - 1)^2))^(1/2) - (400*Pim*mu_i)/(49*dz*rho_i^2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3) + (200*mu_i*(eps - 1))/(7*d*eps*rho_i) - (4*(7*Pim*rho_i*d^3*eps^3 - 30000*dz*eps^3*mu_i^2 + 90000*dz*eps^2*mu_i^2 - 90000*dz*eps*mu_i^2 + 30000*dz*mu_i^2))/(147*d^2*dz*eps^2*rho_i^2*(eps - 1)*(((64*(7*Pim*rho_i*d^3*eps^3 - 30000*dz*eps^3*mu_i^2 + 90000*dz*eps^2*mu_i^2 - 90000*dz*eps*mu_i^2 + 30000*dz*mu_i^2)^3)/(3176523*d^6*dz^3*eps^6*rho_i^6*(eps - 1)^3) + (4*(49*R*T*n*d^4*eps^3*rho_i^2 - 1400*A_f*Pim*d^3*eps^4*mu_i*rho_i + 1400*A_f*Pim*d^3*eps^3*mu_i*rho_i + 4000000*A_f*dz*eps^4*mu_i^3 - 16000000*A_f*dz*eps^3*mu_i^3 + 24000000*A_f*dz*eps^2*mu_i^3 - 16000000*A_f*dz*eps*mu_i^3 + 4000000*A_f*dz*mu_i^3)^2)/(117649*A_f^2*d^6*dz^2*eps^6*rho_i^6*(eps - 1)^2))^(1/2) - (400*Pim*mu_i)/(49*dz*rho_i^2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3))

%u_i = (((64*(7*Pim*rho_i*d^3*eps^3 - 30000*dz*eps^3*mu_i^2 + 90000*dz*eps^2*mu_i^2 - 90000*dz*eps*mu_i^2 + 30000*dz*mu_i^2)^3)/(3176523*d^6*dz^3*rho_i^6*(eps - 1)^3) + (4*(- 49*R*T*n*d^4*eps^2*rho_i^2 - 1400*A_f*Pim*d^3*eps^4*mu_i*rho_i + 1400*A_f*Pim*d^3*eps^3*mu_i*rho_i + 4000000*A_f*dz*eps^4*mu_i^3 - 16000000*A_f*dz*eps^3*mu_i^3 + 24000000*A_f*dz*eps^2*mu_i^3 - 16000000*A_f*dz*eps*mu_i^3 + 4000000*A_f*dz*mu_i^3)^2)/(117649*A_f^2*d^6*dz^2*rho_i^6*(eps - 1)^2))^(1/2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*rho_i^3) - (400*Pim*eps^3*mu_i)/(49*dz*rho_i^2) - (2*R*T*d*eps^2*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3) + (200*mu_i*(eps - 1))/(7*d*rho_i) - (4*(7*Pim*rho_i*d^3*eps^3 - 30000*dz*eps^3*mu_i^2 + 90000*dz*eps^2*mu_i^2 - 90000*dz*eps*mu_i^2 + 30000*dz*mu_i^2))/(147*d^2*dz*rho_i^2*(eps - 1)*(((64*(7*Pim*rho_i*d^3*eps^3 - 30000*dz*eps^3*mu_i^2 + 90000*dz*eps^2*mu_i^2 - 90000*dz*eps*mu_i^2 + 30000*dz*mu_i^2)^3)/(3176523*d^6*dz^3*rho_i^6*(eps - 1)^3) + (4*(- 49*R*T*n*d^4*eps^2*rho_i^2 - 1400*A_f*Pim*d^3*eps^4*mu_i*rho_i + 1400*A_f*Pim*d^3*eps^3*mu_i*rho_i + 4000000*A_f*dz*eps^4*mu_i^3 - 16000000*A_f*dz*eps^3*mu_i^3 + 24000000*A_f*dz*eps^2*mu_i^3 - 16000000*A_f*dz*eps*mu_i^3 + 4000000*A_f*dz*mu_i^3)^2)/(117649*A_f^2*d^6*dz^2*rho_i^6*(eps - 1)^2))^(1/2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*rho_i^3) - (400*Pim*eps^3*mu_i)/(49*dz*rho_i^2) - (2*R*T*d*eps^2*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3));

%u_i =  (((512*(7*Pim*rho_i*d^3*eps^3 - 15000*dz*eps^3*mu_i^2 + 45000*dz*eps^2*mu_i^2 - 45000*dz*eps*mu_i^2 + 15000*dz*mu_i^2)^3)/(3176523*d^6*dz^3*rho_i^6*(eps - 1)^3) + (4*(49*R*T*n*d^4*eps^2*rho_i^2 - 2800*A_f*Pim*d^3*eps^4*mu_i*rho_i + 2800*A_f*Pim*d^3*eps^3*mu_i*rho_i + 4000000*A_f*dz*eps^4*mu_i^3 - 16000000*A_f*dz*eps^3*mu_i^3 + 24000000*A_f*dz*eps^2*mu_i^3 - 16000000*A_f*dz*eps*mu_i^3 + 4000000*A_f*dz*mu_i^3)^2)/(117649*A_f^2*d^6*dz^2*rho_i^6*(eps - 1)^2))^(1/2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*rho_i^3) - (800*Pim*eps^3*mu_i)/(49*dz*rho_i^2) + (2*R*T*d*eps^2*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3) + (200*mu_i*(eps - 1))/(7*d*rho_i) - (8*(7*Pim*rho_i*d^3*eps^3 - 15000*dz*eps^3*mu_i^2 + 45000*dz*eps^2*mu_i^2 - 45000*dz*eps*mu_i^2 + 15000*dz*mu_i^2))/(147*d^2*dz*rho_i^2*(eps - 1)*(((512*(7*Pim*rho_i*d^3*eps^3 - 15000*dz*eps^3*mu_i^2 + 45000*dz*eps^2*mu_i^2 - 45000*dz*eps*mu_i^2 + 15000*dz*mu_i^2)^3)/(3176523*d^6*dz^3*rho_i^6*(eps - 1)^3) + (4*(49*R*T*n*d^4*eps^2*rho_i^2 - 2800*A_f*Pim*d^3*eps^4*mu_i*rho_i + 2800*A_f*Pim*d^3*eps^3*mu_i*rho_i + 4000000*A_f*dz*eps^4*mu_i^3 - 16000000*A_f*dz*eps^3*mu_i^3 + 24000000*A_f*dz*eps^2*mu_i^3 - 16000000*A_f*dz*eps*mu_i^3 + 4000000*A_f*dz*mu_i^3)^2)/(117649*A_f^2*d^6*dz^2*rho_i^6*(eps - 1)^2))^(1/2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*rho_i^3) - (800*Pim*eps^3*mu_i)/(49*dz*rho_i^2) + (2*R*T*d*eps^2*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3));
