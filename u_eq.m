function u_i = u_eq(n, T, u_im, mu_i, mu_im, eps, d, rho_i, rho_im, Pim, A_f, dz)

R = 8.314;

u_i = ((((8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (100*mu_i*(4*Pim*d^2*eps^2 + 7*dz*rho_im*d*eps^2*u_im^2 - 7*dz*rho_im*d*eps*u_im^2 - 600*dz*mu_im*eps^2*u_im + 1200*dz*mu_im*eps*u_im - 600*dz*mu_im*u_im))/(49*d^2*dz*eps^2*rho_i^2) - (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^2 + (- 28*Pim*rho_i*d^3*eps^3 - 49*dz*rho_i*rho_im*d^2*eps^3*u_im^2 + 49*dz*rho_i*rho_im*d^2*eps^2*u_im^2 + 4200*dz*mu_im*rho_i*d*eps^3*u_im - 8400*dz*mu_im*rho_i*d*eps^2*u_im + 4200*dz*mu_im*rho_i*d*eps*u_im - 120000*dz*eps^3*mu_i^2 + 360000*dz*eps^2*mu_i^2 - 360000*dz*eps*mu_i^2 + 120000*dz*mu_i^2)^3/(3176523*d^6*dz^3*eps^6*rho_i^6*(eps - 1)^3))^(1/2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (100*mu_i*(4*Pim*d^2*eps^2 + 7*dz*rho_im*d*eps^2*u_im^2 - 7*dz*rho_im*d*eps*u_im^2 - 600*dz*mu_im*eps^2*u_im + 1200*dz*mu_im*eps*u_im - 600*dz*mu_im*u_im))/(49*d^2*dz*eps^2*rho_i^2) - (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3) + (200*mu_i*(eps - 1))/(7*d*eps*rho_i) - (- 28*Pim*rho_i*d^3*eps^3 - 49*dz*rho_i*rho_im*d^2*eps^3*u_im^2 + 49*dz*rho_i*rho_im*d^2*eps^2*u_im^2 + 4200*dz*mu_im*rho_i*d*eps^3*u_im - 8400*dz*mu_im*rho_i*d*eps^2*u_im + 4200*dz*mu_im*rho_i*d*eps*u_im - 120000*dz*eps^3*mu_i^2 + 360000*dz*eps^2*mu_i^2 - 360000*dz*eps*mu_i^2 + 120000*dz*mu_i^2)/(147*d^2*dz*eps^2*rho_i^2*(eps - 1)*((((8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (100*mu_i*(4*Pim*d^2*eps^2 + 7*dz*rho_im*d*eps^2*u_im^2 - 7*dz*rho_im*d*eps*u_im^2 - 600*dz*mu_im*eps^2*u_im + 1200*dz*mu_im*eps*u_im - 600*dz*mu_im*u_im))/(49*d^2*dz*eps^2*rho_i^2) - (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^2 + (- 28*Pim*rho_i*d^3*eps^3 - 49*dz*rho_i*rho_im*d^2*eps^3*u_im^2 + 49*dz*rho_i*rho_im*d^2*eps^2*u_im^2 + 4200*dz*mu_im*rho_i*d*eps^3*u_im - 8400*dz*mu_im*rho_i*d*eps^2*u_im + 4200*dz*mu_im*rho_i*d*eps*u_im - 120000*dz*eps^3*mu_i^2 + 360000*dz*eps^2*mu_i^2 - 360000*dz*eps*mu_i^2 + 120000*dz*mu_i^2)^3/(3176523*d^6*dz^3*eps^6*rho_i^6*(eps - 1)^3))^(1/2) + (8000000*mu_i^3*(eps - 1)^3)/(343*d^3*eps^3*rho_i^3) + (100*mu_i*(4*Pim*d^2*eps^2 + 7*dz*rho_im*d*eps^2*u_im^2 - 7*dz*rho_im*d*eps*u_im^2 - 600*dz*mu_im*eps^2*u_im + 1200*dz*mu_im*eps*u_im - 600*dz*mu_im*u_im))/(49*d^2*dz*eps^2*rho_i^2) - (2*R*T*d*n)/(7*A_f*dz*rho_i*(eps - 1)))^(1/3));
                                                                                                                                                                          